{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2>Confirm Funds</h2>
  <p>We detected these fund codes. Enter names and choose fund type. This will be remembered next year.</p>

  <form action="/tb/import" method="post">
    <!-- pass-through wizard state -->
    <input type="hidden" name="upload_id" value="{{ upload_id }}" />
    <input type="hidden" name="has_headers" value="{{ has_headers }}" />
    <input type="hidden" name="delimiter" value="{{ delimiter }}" />
    <input type="hidden" name="header_row" value="{{ header_row }}" />

    <!-- mapping carry-forward -->
    <input type="hidden" name="account_col" value="{{ mapping.account_col }}" />
    <input type="hidden" name="desc_col" value="{{ mapping.desc_col or '' }}" />

    <input type="hidden" name="amount_mode" value="{{ mapping.mode }}" />
    <input type="hidden" name="balance_col" value="{{ mapping.balance_col or '' }}" />
    <input type="hidden" name="debit_col" value="{{ mapping.debit_col or '' }}" />
    <input type="hidden" name="credit_col" value="{{ mapping.credit_col or '' }}" />
    <input type="hidden" name="credit_sign_mode" value="{{ mapping.credit_sign_mode }}" />

    <input type="hidden" name="fund_mode" value="{{ mapping.fund_mode }}" />
    <input type="hidden" name="fund_col" value="{{ mapping.fund_col or '' }}" />
    <input type="hidden" name="fund_delimiter" value="{{ mapping.fund_delimiter }}" />

    <table>
      <thead>
        <tr>
          <th>Fund Code</th>
          <th>Rows</th>
          <th>Fund Name</th>
          <th>Fund Type</th>
        </tr>
      </thead>
      <tbody>
        {% for code in fund_codes %}
        <tr>
          <td><b>{{ code }}</b></td>
          <td>{{ fund_counts[code] }}</td>
          <td>
            <input type="text" name="fund_name__{{ code }}" placeholder="e.g., General Fund" style="width: 100%;" />
          </td>
          <td>
            <select name="fund_type__{{ code }}" required>
              <option value="" selected>(select)</option>
              <option value="governmental">Governmental</option>
              <option value="proprietary">Proprietary</option>
              <option value="fiduciary">Fiduciary</option>
              <option value="component_unit">Component Unit</option>
            </select>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <br/>
    <button class="btn btn-primary" type="submit">Import TB</button>
    <a class="btn" href="/">Start Over</a>
  </form>
</div>
{% endblock %}
