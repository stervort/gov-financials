{# api/app/templates/upload.html #}
{% extends "base.html" %}

{% block content %}
<div class="card">
  <h2>Upload Trial Balance (Excel .xlsx)</h2>

  {% if message %}
    <div class="err" style="margin-bottom:12px;">
      {{ message }}
    </div>
  {% endif %}

  <p class="muted" style="margin-top:0;">
    <b>Binder:</b> {{ binder_label or "—" }}
  </p>

  <form action="/tb/upload" method="post" enctype="multipart/form-data">
    {# binder-scoped TB upload #}
    <input type="hidden" name="binder_id" value="{{ binder_id }}">

    <div class="row">
      <div class="col">
        <label><b>Excel file (.xlsx)</b></label><br>
        <input
          type="file"
          name="file"
          accept=".xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
          required
        >
        <div class="muted" style="margin-top:6px;">
          Upload the trial balance for this binder period. Excel only.
        </div>
      </div>
    </div>

    <br>

    <button class="btn btn-primary" type="submit">Upload & Preview</button>
    <a class="btn" href="/binder/{{ binder_id }}/dashboard">Back to Binder</a>
  </form>

  <p class="muted" style="margin-top:12px;">
    This MVP supports Excel only. Exporting to CSV is unnecessary—just upload the .xlsx trial balance.
  </p>
</div>
{% endblock %}
